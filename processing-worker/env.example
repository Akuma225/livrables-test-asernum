# Contenu à copier dans `processing-worker/.env.example` (fichier .env.* bloqué ici)
# Ajusté pour la config Docker Compose racine (postgres/redis/kafka/rustfs/clamav en noms de services).

# ─────────────────────────────────────────────────────────────
# App
# ─────────────────────────────────────────────────────────────
# En conteneur, le service écoute en interne sur 3000.
APP_PORT=3000
# Exposé sur le host par le compose via PROCESSING_WORKER_PORT (par défaut 3003)
APP_BASE_URL=http://localhost:3003
ENV=local

# ─────────────────────────────────────────────────────────────
# Swagger
# ─────────────────────────────────────────────────────────────
SWAGGER_TITLE=Asernum File Management - Processing Worker API
SWAGGER_DESCRIPTION="Service de traitement des fichiers en staging"
SWAGGER_VERSION=1.0.0

# ─────────────────────────────────────────────────────────────
# Auth (utilisé par ta stratégie JWT)
# ─────────────────────────────────────────────────────────────
ACCESS_TOKEN_SECRET=c8097782a33c4682a85c84ee942b5641f1d2209e0ba6ec0ce00079471ea69abd

# ─────────────────────────────────────────────────────────────
# Database (Postgres du compose racine)
# ─────────────────────────────────────────────────────────────
DATABASE_URL=postgresql://admin:1234@postgres:5432/asernum-documents-db

# ─────────────────────────────────────────────────────────────
# Redis (BullMQ)
# ─────────────────────────────────────────────────────────────
REDIS_HOST=redis
REDIS_PORT=6379

# ─────────────────────────────────────────────────────────────
# BullMQ (valeurs lues par le code)
# ─────────────────────────────────────────────────────────────
BULLMQ_ATTEMPTS=3
BULLMQ_BACKOFF_MS=5000
BULLMQ_REMOVE_ON_FAIL=1000

# (Optionnel) tu avais BULLMQ_CONCURRENCY, mais ton code utilise surtout KAFKA_CONCURRENCY côté consumer.
# On te le laisse en exemple si tu le consommes ailleurs.
BULLMQ_CONCURRENCY=3

# ─────────────────────────────────────────────────────────────
# Kafka (conteneur -> listener INTERNAL)
# ─────────────────────────────────────────────────────────────
KAFKA_BROKER_URL=kafka:9093
KAFKA_CLIENT_ID=processing-worker
KAFKA_GROUP_ID=processing-worker

# Concurrence consumer (c’est bien cette variable que ton code lit)
KAFKA_CONCURRENCY=1

# ─────────────────────────────────────────────────────────────
# ClamAV (conteneur clamav)
# ─────────────────────────────────────────────────────────────
CLAMAV_HOST=clamav
CLAMAV_PORT=3310
CLAMAV_TIMEOUT=60000

# ─────────────────────────────────────────────────────────────
# RustFS (S3-compatible, conteneur rustfs)
# ─────────────────────────────────────────────────────────────
RUSTFS_ENDPOINT=http://rustfs:9000
RUSTFS_REGION=us-east-1

# Valeurs par défaut du compose racine (à ajuster si tu changes rustfs)
RUSTFS_ACCESS_KEY=rustfsadmin
RUSTFS_SECRET_KEY=z7i9zkj2iq8baug6

# Buckets (créés automatiquement par rustfs-init)
RUSTFS_BUCKET=asernum-staging
RUSTFS_PRODUCTION_BUCKET=asernum-production
RUSTFS_QUARANTINE_BUCKET=asernum-quarantine
RUSTFS_FAILED_BUCKET=asernum-failed

# ─────────────────────────────────────────────────────────────
# Divers
# ─────────────────────────────────────────────────────────────
USER_QUOTA_LIMIT=100
MULTER_MAX_FILE_SIZE=100

